---
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import Hero from "../components/Hero.astro";
import BentoCard from "../components/BentoCard.astro";
import ResearchArea from "../components/ResearchArea.astro";
import MemberSection from "../components/MemberSection.astro";
import NewsItem from "../components/NewsItem.astro";
import PublicationItem from "../components/PublicationItem.astro";

import { getCollection } from "astro:content";

const research = await getCollection("research");
const members = await getCollection("members");
const researchFocus = await getCollection("research-focus");
const publicationsCollection = await getCollection("publications");
const publicationsEntry = publicationsCollection.find((p) => p.id === "list");
const publications = publicationsEntry ? publicationsEntry.data : [];

import news from "../data/news.yaml";

// Sort collections
research.sort((a, b) => a.data.order - b.data.order);
research.sort((a, b) => a.data.order - b.data.order);
members.sort((a, b) => a.data.order - b.data.order);
researchFocus.sort((a, b) => a.data.order - b.data.order);
// News is already in order in the hardcoded array
// Publications are already sorted in the list file
---

<Layout title="坂田・森・浅谷・西本研究室 | 東京大学">
  <Header />

  <main>
    <Hero />

    <div class="bento-grid">
      <!-- Lab Guidelines (Full Width) -->
      <BentoCard title="研究室の指針" class="guidelines-card full-width">
        <div class="guidelines-content collapsed" id="guidelines-content">
          <div class="guidelines-text">
            <p>
              2009年にスタートし、開設15年になる我々の研究室では、経済・社会に関する洞察とAI・データサイエンスの手法を組み合わせることで、技術経営学の領域で新境地を切り開き、また、世界のトップチームの一つとなることを目指しています。分析手法としては、技術経営領域でもその活用が期待されている機械学習・深層学習、ネットワーク解析、自然言語処理等のデータサイエンス系の手法を中心とし、また、手法自体に関する基礎的な研究も重視しています。
            </p>
            <p>
              そうした手法を用いた考察の対象としては、大規模な学術ビックデータ、ソーシャルメディア、取引関係やM&A等を含む大規模な企業情報、列車を利用したトリップデータ、レビュー文など、様々なものを扱っています。生成AIに関しては、逆学習を用いたLLMの解析に先駆的に取り組んでいます。
            </p>
            <p>
              さらに、このような研究を進めるための外部連携として、「テクノロジー・インフォマティックス社会連携講座」や「事前学習言語モデルとネットワークの融合に基づく科学技術トレンド予測（NEDO/産業技術総合研究所）」の代表を務めるほか、多様な企業等と共同研究を行っています。
            </p>
            <p>
              研究に加えて、成果の発信や社会への貢献も重視しています。リサーチインテリジェンス等の国際会議で招待講演を行うほか、UTOKYO
              COMPASS推進に関する様々な活動（グローバル・コモンズ、ビジョン形成、SDGs国際シンポジウム）、地方創成策や国土計画の政策立案への参加をしています。また、学術ビックデータに関する開拓した技法群を実装したウエブシステム「学術俯瞰・未来予測システム」の東京大学内外への提供を行っています。さらに、「アントレプレナーシップ教育デザイン寄付講座」の運営を担っています。
            </p>
            <p>
              学生のみなさんには、研究テーマの選定から、研究デザイン、分析、論文化まで、一連のプロセスを主体的にまわす経験をしてもらうことを重視しています。教員の側から研究テーマや研究計画の示唆をすることは控え、みなさんが自ら選んだテーマや設計した研究計画の支援に徹することとしています。こうしたことから、研究室内の研究テーマは実に多様なものとなっています。
            </p>
            <p>
              また、学生のみなさんが学会での発表や国際経験を得ることも重視しています。国内については、人工知能学会や情報処理学会、言語処理学会等、データサイエンス系の学会において多数の発表を行っており、優秀賞を連続して受賞しています。海外においては、技術経営系の主要な国際会議（PICMET等）で多数の発表を行うほか、自然言語処理のトップカンファレンス（ACLやEMNLP）、ネットワーク科学系の国際会議（Complex
              NetworksやNetSci）、計算社会科学の国際会議（IC2S2）、サイエンス・オブ・サイエンスの国際会議（ICSSI）での発表実績が出ています。海外の提携校との交換留学も積極的に後押ししています。
            </p>
            <p>意欲ある学生のみなさんを待っています。</p>
            <p style="text-align: right; margin-top: 1rem;">
              工学系研究科技術経営戦略学専攻 教授 坂田一郎
            </p>
          </div>
        </div>
        <button
          id="guidelines-toggle"
          class="guidelines-toggle"
          aria-label="Expand"
        >
          ...
        </button>
      </BentoCard>

      <!-- News Area (Left 2/3) -->
      <BentoCard title="News" class="news-card span-2 tall-1-4">
        <div class="news-preview">
          {
            news
              .slice(0, 5)
              .map((item: { date: string; text: string; link?: string }) => (
                <div class="news-preview-item">
                  <span class="date">{item.date}</span>
                  {item.link ? (
                    <a
                      href={item.link}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="text link"
                    >
                      {item.text}
                    </a>
                  ) : (
                    <span class="text">{item.text}</span>
                  )}
                </div>
              ))
          }
        </div>
        <a href="/news" class="view-all-link">すべて見る →</a>
      </BentoCard>

      <!-- Members Area (Right 1/3) -->
      <BentoCard
        title="Members"
        class="members-card span-1 tall-1-4"
        href="/members"
      >
        <div class="members-preview">
          {
            members.slice(0, 3).map((group) => (
              <div class="member-group">
                <h4>{group.data.title}</h4>
                <ul>
                  {group.data.items.slice(0, 3).map((member) => (
                    <li>{member.name}</li>
                  ))}
                </ul>
              </div>
            ))
          }
        </div>
      </BentoCard>

      <!-- Research (Full Width) -->
      <BentoCard
        title="Research"
        class="research-card full-width tall-huge"
        href="/research"
      >
        <div class="research-preview">
          <h3>技術経営学 / 計算社会科学 / 計算言語学</h3>
          <p>
            2009年にスタートし、開設15年になる我々の研究室では、経済・社会に関する洞察とAI・データサイエンスの手法を組み合わせることで、技術経営学の領域で新境地を切り開き、また、世界のトップチームの一つとなることを目指しています。分析手法としては、技術経営領域でもその活用が期待されている機械学習・深層学習、ネットワーク解析、自然言語処理等のデータサイエンス系の手法を中心とし、また、手法自体に関する基礎的な研究も重視しています。
          </p>
          <p>
            そうした手法を用いた考察の対象としては、大規模な学術ビックデータ、ソーシャルメディア、取引関係やM&A等を含む大規模な企業情報、列車を利用したトリップデータ、レビュー文など、様々なものを扱っています。生成AIに関しては、逆学習を用いたLLMの解析に先駆的に取り組んでいます。
          </p>
          <p>
            さらに、このような研究を進めるための外部連携として、「テクノロジー・インフォマティックス社会連携講座」や「事前学習言語モデルとネットワークの融合に基づく科学技術トレンド予測（NEDO/産業技術総合研究所）」の代表を務めるほか、多様な企業等と共同研究を行っています。
          </p>
        </div>
      </BentoCard>

      <!-- Research Focus Boxes (Show only 3) -->
      {
        researchFocus.slice(0, 3).map((focus) => (
          <a
            href={`/research/focus${focus.data.order}`}
            class="research-focus-link"
          >
            <BentoCard
              title={focus.data.title}
              label={focus.data.label}
              class="research-focus-card span-1 fixed-height"
            >
              <div class="focus-preview">
                <p>{focus.data.description}</p>
                <div class="focus-tags">
                  <span class="focus-tag">Publications</span>
                  <span class="focus-tag">Projects</span>
                </div>
              </div>
            </BentoCard>
          </a>
        ))
      }

      <!-- Publications Area -->
      <BentoCard title="Publications" class="publications-card full-width">
        <div class="publications-list-compact">
          {
            publications
              .filter((p) => !p.hidden)
              .slice(0, 5)
              .map((pub) => (
                <div class="pub-item-compact">
                  <span class="pub-year">{pub.year}</span>
                  <span class="pub-title">{pub.title}</span>
                  <span class="pub-venue">{pub.venue}</span>
                </div>
              ))
          }
        </div>
        <a href="/publications" class="view-all-link">すべて見る →</a>
      </BentoCard>

      <!-- Join Us (Left 2/3) -->
      <BentoCard
        title="新入生の方へ"
        label="Join Us"
        class="span-2"
        href="/visit"
      >
        <p>
          研究室見学を随時受け付けています。研究会（月1回・木曜4限）や輪読会の見学を推奨しています。
        </p>
        <p
          style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--text-muted);"
        >
          どの教員に配属となっても同じ環境で指導を受けられます。
        </p>
      </BentoCard>

      <!-- Contact (Right 1/3) -->
      <BentoCard title="アクセス" label="Contact" id="contact" class="span-1">
        <div class="contact-info">
          <div class="contact-row">
            <svg
              class="contact-icon"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
              ></path>
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            東京大学 本郷キャンパス<br />工学部3号館 202号室
          </div>
          <div class="contact-row">
            <svg
              class="contact-icon"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
              ></path>
            </svg>
            info@ipr-ctr.t.u-tokyo.ac.jp
          </div>
        </div>
      </BentoCard>
    </div>
  </main>

  <Footer />

  <script is:inline>
    // Guidelines toggle
    const toggleBtn = document.getElementById("guidelines-toggle");
    const content = document.getElementById("guidelines-content");

    if (toggleBtn && content) {
      toggleBtn.addEventListener("click", () => {
        content.classList.toggle("collapsed");
        toggleBtn.textContent = content.classList.contains("collapsed")
          ? "..."
          : "Close";
      });
    }
  </script>
</Layout>

<style>
  main {
    max-width: 1200px;
    margin: 0 auto;
    padding: 6rem 2rem 4rem;
  }

  .bento-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }

  /* Specific Card Styles */
  :global(.bento-card.full-width) {
    grid-column: 1 / -1;
  }

  :global(.bento-card.large) {
    min-height: 300px;
  }

  :global(.bento-card.wide) {
    grid-column: span 2;
    min-height: 200px;
  }

  :global(.bento-card.span-1) {
    grid-column: span 1;
  }

  .guidelines-text {
    font-size: 0.95rem;
    line-height: 1.8;
    color: var(--text-secondary);
  }

  .guidelines-text p {
    margin-bottom: 1rem;
  }

  :global(.bento-card.span-2) {
    grid-column: span 2;
  }

  :global(.bento-card.tall-1-4) {
    min-height: 420px; /* Approx 1.4x of 300px */
  }

  :global(.bento-card.tall-1-5) {
    min-height: 450px; /* 1.5x of 300px */
  }

  :global(.bento-card.tall-huge) {
    /* min-height: 700px; ~2x+ of 300px */
  }

  :global(.bento-card.tall-2) {
    min-height: 600px; /* 2x of 300px */
  }

  :global(.bento-card.fixed-height) {
    height: 200px;
    overflow: hidden;
  }

  .guidelines-content {
    transition: max-height 0.3s ease;
    overflow: hidden;
  }

  .guidelines-content.collapsed {
    max-height: 80px; /* Reduced height */
    mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
  }

  .guidelines-toggle {
    display: block;
    width: 100%;
    padding: 0.5rem;
    background: none;
    border: none;
    color: var(--accent);
    font-size: 1.5rem;
    cursor: pointer;
    line-height: 1;
    margin-top: 0.5rem;
  }

  .guidelines-toggle:hover {
    color: var(--accent-light);
  }

  @media (max-width: 900px) {
    :global(.bento-card.span-2) {
      grid-column: span 3; /* Full width on tablet */
    }
  }

  .research-preview h3,
  .visit-preview h3 {
    font-size: 1.1rem;
    color: var(--accent);
    margin-bottom: 0.5rem;
  }

  .news-preview {
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
  }

  .news-preview-item {
    display: flex;
    gap: 1rem;
    font-size: 0.9rem;
  }

  .news-preview-item .date {
    color: var(--text-muted);
    font-family: var(--font-mono);
    white-space: nowrap;
  }

  .news-preview-item .text.link {
    text-decoration: underline;
    text-decoration-color: var(--accent);
    text-underline-offset: 2px;
    color: inherit;
  }

  .news-preview-item .text.link:hover {
    color: var(--accent);
  }

  .view-all-link {
    display: inline-block;
    margin-top: 1rem;
    font-size: 0.85rem;
    color: var(--accent);
    text-decoration: none;
    font-weight: 500;
    transition: transform 0.2s ease;
  }

  .view-all-link:hover {
    transform: translateX(4px);
  }

  @media (max-width: 768px) {
    .bento-grid {
      grid-template-columns: 1fr;
    }

    :global(.bento-card.wide),
    :global(.bento-card.large) {
      grid-column: span 1;
    }
  }

  /* Keywords */
  .keywords {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
    margin-top: 0.75rem;
  }

  .keyword {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    padding: 0.25rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    color: var(--text-secondary);
  }

  /* Contact card */
  .contact-info {
    margin-top: 0.5rem;
  }

  .contact-row {
    display: flex;
    align-items: flex-start;
    gap: 0.6rem;
    margin-bottom: 0.6rem;
    font-size: 0.8rem;
    color: var(--text-secondary);
    line-height: 1.5;
  }

  .contact-icon {
    color: var(--accent-light);
    width: 14px;
    flex-shrink: 0;
    margin-top: 2px;
  }

  /* News List */
  .news-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-top: 0.5rem;
  }

  :global(.bento-card.expanded) .news-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 1rem;
  }

  /* Pub List */
  .pub-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-top: 0.5rem;
  }

  :global(.bento-card.expanded) .pub-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 1rem;
  }

  /* Research Focus Links */
  .research-focus-link {
    text-decoration: none;
    color: inherit;
    display: block;
    transition: transform 0.2s ease;
  }

  .research-focus-link:hover {
    transform: translateY(-2px);
  }

  .focus-preview p {
    font-size: 0.9rem;
    color: var(--text-secondary);
    line-height: 1.6;
    margin-bottom: 1rem;
  }

  .focus-tags {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .focus-tag {
    font-size: 0.7rem;
    padding: 0.15rem 0.5rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 12px;
    color: var(--text-secondary);
  }

  .focus-full {
    animation: fadeIn 0.3s ease;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @media (max-width: 900px) {
    .bento-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    :global(.bento-card.expanded) .pub-list,
    :global(.bento-card.expanded) .news-list {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 600px) {
    main {
      padding: 5rem 1rem 2rem;
    }

    .bento-grid {
      grid-template-columns: 1fr;
    }
  }

  /* Members Preview */
  .members-preview {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .member-group h4 {
    font-size: 0.85rem;
    color: var(--accent);
    margin-bottom: 0.5rem;
    font-weight: 600;
  }

  .member-group ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.3rem;
  }

  .member-group li {
    font-size: 0.85rem;
    color: var(--text-secondary);
  }

  /* Publications Preview */
  .publications-preview {
    display: flex;
    overflow-x: auto;
    gap: 1.5rem;
    padding-bottom: 1rem; /* Space for scrollbar */
    scrollbar-width: thin;
  }

  .publications-preview::-webkit-scrollbar {
    height: 6px;
  }

  .publications-preview::-webkit-scrollbar-thumb {
    background-color: var(--border);
    border-radius: 3px;
  }

  .pub-preview-item {
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
    min-width: 300px;
    flex-shrink: 0;
  }

  .pub-meta {
    display: flex;
    gap: 0.5rem;
    align-items: center;
  }

  .pub-year {
    font-family: var(--font-mono);
    font-size: 0.75rem;
    color: var(--text-muted);
  }

  .pub-category {
    font-size: 0.7rem;
    padding: 0.15rem 0.5rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 3px;
    color: var(--text-secondary);
    text-transform: uppercase;
  }

  .pub-title {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-primary);
    line-height: 1.4;
    margin: 0;
  }

  .pub-authors {
    font-size: 0.75rem;
    color: var(--text-secondary);
    margin: 0;
  }

  .pub-venue {
    font-size: 0.75rem;
    color: var(--text-muted);
    font-style: italic;
    margin: 0;
  }

  @media (max-width: 900px) {
    .publications-preview {
      grid-template-columns: 1fr;
    }
  }

  .publications-list-compact {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .pub-item-compact {
    display: flex;
    align-items: baseline;
    gap: 0.8rem;
    font-size: 0.9rem;
    line-height: 1.4;
    white-space: nowrap;
    overflow: hidden;
  }

  .pub-item-compact .pub-year {
    font-family: var(--font-mono);
    color: var(--accent);
    font-weight: 600;
    flex-shrink: 0;
  }

  .pub-item-compact .pub-title {
    font-weight: 500;
    color: var(--text-primary);
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .pub-item-compact .pub-venue {
    color: var(--text-muted);
    font-size: 0.8rem;
    flex-shrink: 0;
  }
</style>
